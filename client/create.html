<!--DEEPSTREAM-->
<template name="add_context">
  <div class="add-context narrative-section selected editing">
    {{#if listMode}}
      {{> Template.dynamic template=searchListTemplate}}
    {{else}}
      {{> Template.dynamic template=searchSoloTemplate}}
    {{/if}}
  </div>
</template>

<template name="stream_search">
  <div class="add-context stream-search narrative-section selected editing">
    {{> create_stream_section}}
  </div>
</template>


<template name="search_form">
  <div class="search-form">
    <form>
      <div class="search-outside-input-container">
        <div class="search-trigger">{{#if searchInputLabel}}{{searchInputLabel}}{{else}}Search{{/if}}</div>
        <div class="search-input-container">
          <input type="search" placeholder={{placeholder}} autofocus="autofocus" dir="auto">
        </div>
        <button type="submit" class="search-button">{{> search_icon }}</button>
      </div>
      {{#if option1}}
        <div class="search-radios">
          <input type="radio" name="option" value="{{option1}}" id="{{randomIdPrefix}}{{option1}}"  checked />
          <label for="{{randomIdPrefix}}{{option1}}">{{label1}}</label>
          {{#if option2}}
            <input type="radio" name="option" value="{{option2}}" id="{{randomIdPrefix}}{{option2}}"  />
            <label for="{{randomIdPrefix}}{{option2}}">{{label2}}</label>
            {{#if option3}}
              <input type="radio" name="option" value="{{option3}}" id="{{randomIdPrefix}}{{option3}}"  />
              <label for="{{randomIdPrefix}}{{option3}}">{{label3}}</label>
            {{/if}}
          {{/if}}
        </div>
      {{/if}}
    </form>
  </div>
</template>

<!-- Create Templates -->

<template name="unimplemented_chat_section">
  <div class="create-section unimplemented">
    Chat. Coming soon!
  </div>
</template>

<template name="create_text_section">
  <div class="search-section-title">Add Text</div>
  <button class="go-back-button">{{> back_arrow_icon}}</button>
  <div class="create-section">
    <div class="tabs">
      <ul>
        {{#each dataSources}}
          <li class="data-source {{#if selected}}selected{{/if}}">{{display}}</li>
        {{/each}}
      </ul>
    </div>
    <div class="text-result-container">
      <textarea name="content" value={{content}} class="text-content editable" rows="40" dir="auto"></textarea>
    </div>
    <button class="add-button">
      Add
    </button>
  </div>
</template>

<template name="create_link_section">
  <div class="search-section-title">Add a Link</div>
  <button class="go-back-button">{{> back_arrow_icon}}</button>
  <div class="create-section create-link-section">
    <div class="tabs">
      <ul>
        {{#each dataSources}}
          <li class="data-source {{#if selected}}selected{{/if}}">{{display}}</li>
        {{/each}}
      </ul>
    </div>

    {{> search_form searchInputLabel='URL' placeholderType='links'}}

    {{#if loading}}
      <div class="preview-section placeholder">
        {{> loading_icon}}
      </div>
    {{else}}
      {{#if noMoreResults}}
        {{noMoreResults}}
      {{/if}}
      {{#if link}}
        {{#with preview}}
          <div class="link-section preview-section">
            <div class="transparent-cover"></div>
            <a href="{{url}}" target="_blank">
              <div class="top">
                {{#if thumbnailUrl}}
                  {{#if imageOnLeft}}
                    <img class="thumbnail left" src="{{thumbnailUrl}}" />
                  {{else}}
                    <div class="thumbnail top" style='background-image: url("{{thumbnailUrl}}")'></div>
                  {{/if}}
                  <div class="link-title {{#if imageOnLeft}}image-on-left{{else}}image-on-top{{/if}}">{{title}}</div>
                {{/if}}
              </div>
            </a>
            <div class="link-description {{#if imageOnLeft}}image-on-left{{else}}image-on-top{{/if}}">{{linkDescription}}</div>
            <div class="bottom">
              <a class="read-more" href="{{url}}" target="_blank">Read more on {{providerTruncatedUrl}}</a>
            </div>
          </div>
        {{/with}}
      {{else}}
        {{#if image}}
          <div class="preview-section image-section">
            <img class="image" src="{{preview.url}}" />
          </div>
        {{else}}

          {{#if video}}
            <div class="preview-section video-section">
              <iframe width="100%" height="300" frameborder="0" style="border:0" src="{{preview.url}}" allowfullscreen></iframe>
            </div>
          {{/if}}
        {{/if}}
      {{/if}}
    {{/if}}
    {{#if showAddButton}}
      <button type="button" class="add-button {{#if isActive}}enabled{{/if}}">
        Add
      </button>
    {{/if}}
  </div>
</template>

<template name="create_news_section">
  <div class="search-section-title">Add a News Story</div>
  <button class="go-back-button">{{> back_arrow_icon}}</button>
  <div class="create-section create-news-section">
    <div class="tabs">
      <ul>
        {{#each dataSources}}
          <li class="data-source {{#if selected}}selected{{/if}}">{{display}}</li>
        {{/each}}
      </ul>
    </div>

    {{> search_form searchInputLabel='URL' placeholderType='news'}}

    {{#if loading}}
      <div class="preview-section placeholder">
        {{> loading_icon}}
      </div>
    {{else}}
      {{#if noMoreResults}}
        {{noMoreResults}}
      {{else}}
        {{#with focusResult}}
          <div class="news-preview search-results-container">
            <div class="news-section">
              {{#if headerImageUrl}}
                <img class="news-header-image" src="{{headerImageUrl}}"/>
              {{/if}}
              <h4 class="news-title">{{title}}</h4>
              <div class="news-date">{{publicationDate}}</div>
              <div class="news-html">{{{html}}}</div>
            </div>
          </div>
        {{/with}}
      {{/if}}
    {{/if}}
    {{#if showAddButton}}
      <button type="button" class="add-button {{#if isActive}}enabled{{/if}}">
        Add
      </button>
    {{/if}}
  </div>
</template>

<template name="create_image_section">
  <div class="search-section-title">Add an Image</div>
  <button class="go-back-button">{{> back_arrow_icon}}</button>
  <div class="create-section create-image-section">
    <div class="search-section {{#unless uploadMode}}{{#if showSingleResult}}hide{{/if}}{{/unless}}">
      <div class="tabs">
        <ul>
          {{#each dataSources}}
            <li class="data-source {{#if selected}}selected{{/if}}">{{display}}</li>
          {{/each}}
        </ul>
      </div>
      {{#if uploadMode}}
        <div class="image-upload">
          {{#c_upload}}
            <input type="file" accept="image/*" class="image-upload">
          {{/c_upload}}

            <!--{{#each c.uploading_images}}-->
          <!--<p>Uploading: {{percent_uploaded}}%</p>-->
            <!--{{/each}}-->
          {{#if uploadStatus}}
            <p>{{uploadStatus}}</p>
          {{/if}}
          <img width="250" src="{{uploadPreview}}">
        </div>
        {{#if showAddButton}}
          <button type="submit" class="add-button">
            Add
          </button>
        {{/if}}
      {{else}}
        {{> search_form}}
        <ol class="search-results-container">
          {{#each results}}
            <li class="tile {{#if isFocused}}focused{{/if}}">
              <img src="{{thumbnailUrl}}">
            </li>
          {{/each}}
          {{#if loading}}
            {{> loading_icon}}
          {{/if}}
          {{#if noMoreResults}}
            {{noMoreResults}}
          {{/if}}
        </ol>
      {{/if}}

    </div>
    {{#unless uploadMode}}
      {{#with focusResult}}
        {{#if showAddButton}}
          <div class="single-result">
            <img src="{{url}}">
            <button type="submit" class="add-button">
              Add
            </button>
          </div>
        {{/if}}
      {{/with}}
    {{/unless}}
  </div>
</template>

<template name="create_map_section">
  <div class="search-section-title">Add a Map</div>
  <button class="go-back-button">{{> back_arrow_icon}}</button>
  <div class="create-section create-map-section">
    <div class="tabs">
      <ul>
        {{#each dataSources}}
          <li class="data-source {{#if selected}}selected{{/if}}">{{display}}</li>
        {{/each}}
      </ul>
    </div>
    {{> search_form option1='satellite' label1='Satellite' option2='roadmap' label2='Roadmap' placeholderType='locations'}}
    <div class="map-result-container">
      <img src="{{previewUrl 200 310}}"/>
    </div>
    {{#if showAddButton}}
      <button type="button" class="add-button {{#if isActive}}enabled{{/if}}">
        Add
      </button>
    {{/if}}
  </div>
</template>


<template name="add_description_section">
  Add description
</template>


<template name="create_twitter_section">
  <div class="search-section-title">Add a Tweet</div>
  <button class="go-back-button">{{> back_arrow_icon}}</button>
  {{#if twitterUser}}
    <div class="create-section twitter">
      <div class="hiding-div {{#if showSingleResult}}hide{{/if}}">

        <div class="tabs">
          <ul>
            {{#each dataSources}}
              <li class="data-source {{#if selected}}selected{{/if}}">{{display}}</li>
            {{/each}}
          </ul>
        </div>
        {{> search_form option1='all' label1='All tweets' option2='user' label2='User' option3= 'favorites' label3='Favorites'}}
        <ol class="search-results-container">
          {{#each results}}
            <li class="{{#if isFocused}}focused{{/if}}">
              <div class="search-result {{#if imgUrl}}image{{/if}}">
                <div class="thumbnail">
                  <a href="//twitter.com/{{screenname}}" target="_blank">
                    <img class="small" src="{{userpic}}">
                  </a>
                </div>
                <div class="info twitter">
                  <div class="content-title">{{username}}
                    <span>
                      <a href="//twitter.com/{{screenname}}" target="_blank">@{{screenname}}</a>
                      </span>
                  </div>
                  <div class="tweet" dir="auto">{{{formattedTweet}}}
                  </div>
                  {{#if imgUrl}}
                    <div>
                      <img src="{{imgUrl}}" class="tweet-image">
                    </div>
                  {{/if}}
                  <div class="descr">
                      <span>
                        <a href={{twitter_url}} target="_blank"><i class="fa fa-twitter"></i></a>
                        {{#if retweetUser}}
                          <a href={{retweet_url}} target="_blank">
                            <i class="fa fa-retweet"></i> @{{retweetUser}}</a>
                        {{/if}}
                        <a href={{tweet_url}} target="_blank">{{date}}</a>
                      </span>
                  </div>
                </div>
              </div>
            </li>
          {{/each}}
          <li class="loading-icon">
            {{#if loading}}
              {{> loading_icon}}
            {{/if}}
            {{#if noMoreResults}}
              {{noMoreResults}}
            {{/if}}
          </li>
        </ol>
      </div>
      {{#with focusResult}}
        <div class="single-result">
          <div class="twitter-section">
          <div class="twitter-text-section {{#if imgUrl}}image{{/if}} ">
            <div class='tweet-card'>
              <div class='title'>
                <div class='prof_pic'>
                  <a href="{{user_url}}" target="_blank">
                    <img src="{{userpic}}">
                  </a>
                </div>
                <div class='username'>
                  <div>{{username}}
                  </div>
                  <div class="screenname"><a href="{{user_url}}" target="_blank">@{{screenname}}</a>
                  </div>
                </div>
              </div>
              <div class="tweet" dir="auto">{{{formattedTweet}}}
              </div>
              <div class="info">
                <span>
                  <a href="{{twitter_url}}" target="_blank"><i class="fa fa-twitter"></i>
                  </a>
                  {{#if retweetUser}}
                    <a href="{{retweet_url}}" target="_blank">
                      <i class="fa fa-retweet"></i>@{{retweetUser}}</a>
                  {{/if}}
                  <a href="{{tweet_url}}" target="_blank">{{date}}</a>
                </span>
              </div>
            </div>
          </div>
          {{#if imgUrl}}
            <div class='image-section'>
              <img src='{{imgUrl}}'>
            </div>
          {{/if}}
          </div>


        </div>
        <button type="button" class="add-button {{#if isActive}}enabled{{/if}}">
          Add
        </button>
      {{/with}}
    </div>
  {{else}}
    <div class="create-section link-twitter">
      {{> link_twitter}}
    </div>
  {{/if}}
</template>

<template name="link_twitter">
  <button class="link-twitter-button">Link Twitter Account</button>
</template>

<template name="create_video_section">
  <div class="search-section-title">Add a Video</div>
  <button class="go-back-button">{{> back_arrow_icon}}</button>
  <div class="create-section">
    <div class="hiding-div {{#if showSingleResult}}hide{{/if}}">
      <div class="tabs">
        <ul>
          {{#each dataSources}}
            <li class="data-source {{#if selected}}selected{{/if}}">{{display}}</li>
          {{/each}}
        </ul>
      </div>
      {{> search_form}}
      <ol class="search-results-container">
        {{#each results}}
          <li>
            <div class="{{#if isFocused}}focused-{{/if}}search-result">
              <div class="{{#if isFocused}}focused-{{/if}}thumbnail">
              <img src="{{thumbnailUrl}}">
              </div>
              <div class="info {{#if isFocused}}focused{{/if}}">
                <div class="content-title">{{title}}</div>
                <div class="descr">{{caption}}</div>
                <div class="user">{{username}}</div>
                <div class="date">{{creationDate}}</div>
              </div>
            </div>
          </li>
        {{/each}}
        <li class="loading-icon">
          {{#if loading}}
            {{> loading_icon}}
          {{/if}}
          {{#if noMoreResults}}
            {{noMoreResults}}
          {{/if}}
        </li>
      </ol>
    </div>
    {{#with focusResult}}
      <div class="single-result">
        <iframe class="video" width="100%" height="200" src="{{url}}"></iframe>
        <div class="info">
          <div class="content-title">{{title}}</div>
          <div class="descr">{{caption}}</div>
          <div class="user">{{username}}</div>
          <div class="date">{{creationDate}}</div>
        </div>
        <button type="button" class="add-button {{#if isActive}}enabled{{/if}}">
          Add
        </button>
      </div>
    {{/with}}
  </div>
</template>

<template name="create_stream_section">
  <div class="search-section-title">Add Streams</div>
  {{#if showSingleResult}}<button class="go-back-button">{{> back_arrow_icon}}</button>{{/if}}
  <div class="create-section add-stream-section">
    <div class="hiding-div {{#if showSingleResult}}hide{{/if}}">
      {{> search_form}}
      <ol class="search-results-container">
        {{#each results}}
          <li>
            <div class="{{#if isFocused}}focused-{{/if}}search-result">
              <div class="{{#if isFocused}}focused-{{/if}}thumbnail">
                <img src="{{thumbnailUrl}}">
              </div>
              <div class="info {{#if isFocused}}focused{{/if}}">
                <div class="content-title">{{title}}</div>
                <div class="descr">{{caption}}</div>
                <div class="user">{{username}}</div>
                <div class="date">{{creationDate}}</div>
              </div>
            </div>
          </li>
        {{/each}}
        <li class="loading-icon">
          {{#if loading}}
            {{> loading_icon}}
          {{/if}}
          {{#if noMoreResults}}
            {{noMoreResults}}
          {{/if}}
        </li>
      </ol>
    </div>
    {{#with focusResult}}
      <div class="single-result">
        <iframe class="video" width="100%" height="200" src="{{url}}"></iframe>
        <div class="info">
          <div class="content-title">{{title}}</div>
          <div class="descr">{{caption}}</div>
          <div class="user">{{username}}</div>
          <div class="date">{{creationDate}}</div>
        </div>
        <button type="button" class="add-button {{#if isActive}}enabled{{/if}}">
          Add
        </button>
      </div>
    {{/with}}
  </div>
</template>

<template name="create_audio_section">
  <div class="search-section-title">Add an Audio Clip</div>
  <button class="go-back-button">{{> back_arrow_icon}}</button>
    <div class="create-section audio">
      <div class="hiding-div {{#if showSingleResult}}hide{{/if}}">
      <div class="tabs">
        <ul>
          {{#each dataSources}}
            <li class="data-source {{#if selected}}selected{{/if}}">{{display}}</li>
          {{/each}}
        </ul>
      </div>
      {{> search_form}}
      <ol class="search-results-container">
        {{#each results}}
          <li>
            <div class="{{#if isFocused}}focused-{{/if}}search-result">
              <div class="{{#if isFocused}}focused-{{/if}}thumbnail">
                {{#if isFocused}}
                  <iframe class="audio" width="100%" src="{{url}}"></iframe>
                {{else}}
                  <div class="thumbnail">
                    {{#if artworkUrl}}
                      <img class="square" src="{{artworkUrl}}" />
                    {{else}}
                      <img class="square" src="https://addons.opera.com/media/extensions/45/11645/0.5-rev2/icons/icon_64x64.png" />
                    {{/if}}
                  </div>
                  <div class="info">
                    <div class="content-title">{{reference.title}}</div>
                    <div class="descr">{{reference.description}}</div>
                    <div class="user">{{reference.username}}</div>
                    <div class="date">{{reference.creationDate}}</div>
                  </div>
                {{/if}}
              </div>
            </div>
          </li>
        {{/each}}
        <li class="loading-icon">
          {{#if loading}}
            {{> loading_icon}}
          {{/if}}
          {{#if noMoreResults}}
            {{noMoreResults}}
          {{/if}}
        </li>
      </ol>
    </div>
      {{#with focusResult}}
        <div class="single-result">
          <iframe class="audio" width="100%" src="{{url}}"></iframe>
          <div class="info">
            <div class="content-title">{{reference.title}}</div>
            <div class="descr">{{reference.description}}</div>
            <div class="user">{{reference.username}}</div>
            <div class="date">{{reference.creationDate}}</div>
          </div>
          <button type="button" class="add-button {{#if isActive}}enabled{{/if}}">
            Add
          </button>
        </div>
      {{/with}}
  </div>
</template>

<template name="back_to_results_button">
  {{#if showBackToResultsButton}}
    <button class="go-back-button">{{> back_arrow_icon}}</button>
  {{/if}}
</template>
